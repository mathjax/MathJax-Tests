import {ParserTest} from './parser-tests.js';
import 'mathjax3/input/tex/mhchem/MhchemConfiguration.js';


class ParserMhchemTest6 extends ParserTest {

  constructor() {
    super();
    this.packages = ['base', 'ams', 'mhchem'];
  }

}

let parserTest = new ParserMhchemTest6();

parserTest.runTest(
  'Chem-60', '\\ce{A\\bond{1}B\\bond{2}C\\bond{3}D}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "A"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "−"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "B"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 3,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 3,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "="}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 3,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 3,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "≡"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "D"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-61', '\\ce{A\\bond{~}B\\bond{~-}C}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "A"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mphantom",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mo",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0,
                                                     "form": "infix"},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "−"}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "mpadded",
                     "texClass": 0,
                     "attributes": {"height": "+2mu",
                                    "depth": "-2mu",
                                    "voffset": "+2mu"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "TeXAtom",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mspace",
                                 "texClass": 0,
                                 "attributes": {"width": "2mu"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [],
                                 "isSpacelike": true},
                                {"kind": "mstyle",
                                 "texClass": 0,
                                 "attributes": {"mathsize": "0.5em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"mathsize": "0.5em",
                                                  "displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "1mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true},
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "1mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true},
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "2mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true}],
                                    "isInferred": true,
                                    "isSpacelike": true}],
                                 "isSpacelike": true}],
                              "isInferred": true,
                              "isSpacelike": true}]}],
                        "isInferred": true}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "B"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "-.1em",
                                                "depth": "+.1em",
                                                "voffset": "-.1em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mo",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0,
                                                           "form": "infix"},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "text",
                                                "text": "−"}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "mpadded",
                     "texClass": 0,
                     "attributes": {"height": "+.1em",
                                    "depth": "-.1em",
                                    "voffset": "+.1em"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "TeXAtom",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "TeXAtom",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mpadded",
                                       "texClass": 0,
                                       "attributes": {"width": 0},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mphantom",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "mo",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"displaystyle": true,
                                                                 "scriptlevel": 0,
                                                                 "form": "infix"},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "text",
                                                      "text": "−"}],
                                                   "isEmbellished": true}],
                                                "isInferred": true,
                                                "isEmbellished": true}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true},
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "+2mu",
                                                "depth": "-2mu",
                                                "voffset": "+2mu"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mspace",
                                             "texClass": 0,
                                             "attributes": {"width": "2mu"},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [],
                                             "isSpacelike": true},
                                            {"kind": "mstyle",
                                             "texClass": 0,
                                             "attributes": {"mathsize": "0.5em"},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"mathsize": "0.5em",
                                                              "displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "mtext",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "text",
                                                      "text": "-"}],
                                                   "isSpacelike": true},
                                                  {"kind": "mspace",
                                                   "texClass": 0,
                                                   "attributes": {"width": "1mu"},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [],
                                                   "isSpacelike": true},
                                                  {"kind": "mtext",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "text",
                                                      "text": "-"}],
                                                   "isSpacelike": true},
                                                  {"kind": "mspace",
                                                   "texClass": 0,
                                                   "attributes": {"width": "1mu"},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [],
                                                   "isSpacelike": true},
                                                  {"kind": "mtext",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "text",
                                                      "text": "-"}],
                                                   "isSpacelike": true},
                                                  {"kind": "mspace",
                                                   "texClass": 0,
                                                   "attributes": {"width": "2mu"},
                                                   "inherited": {"mathsize": "0.5em",
                                                                 "displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [],
                                                   "isSpacelike": true}],
                                                "isInferred": true,
                                                "isSpacelike": true}],
                                             "isSpacelike": true}],
                                          "isInferred": true,
                                          "isSpacelike": true}]}],
                                    "isInferred": true}]}],
                              "isInferred": true}]}],
                        "isInferred": true}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-62', '\\ce{A\\bond{~--}B\\bond{~=}C\\bond{-~-}D}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "A"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "-.2em",
                                                "depth": "+.2em",
                                                "voffset": "-.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mo",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0,
                                                           "form": "infix"},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "text",
                                                "text": "−"}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "+.2em",
                                                "depth": "-.2em",
                                                "voffset": "+.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "TeXAtom",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "mpadded",
                                                   "texClass": 0,
                                                   "attributes": {"width": 0},
                                                   "inherited": {"displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "mrow",
                                                      "texClass": 0,
                                                      "attributes": {},
                                                      "inherited": {"displaystyle": true,
                                                                    "scriptlevel": 0},
                                                      "properties": {},
                                                      "childNodes": [
                                                        {"kind": "mphantom",
                                                         "texClass": 0,
                                                         "attributes": {},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [
                                                           {"kind": "mrow",
                                                            "texClass": 0,
                                                            "attributes": {},
                                                            "inherited": {"displaystyle": true,
                                                                          "scriptlevel": 0},
                                                            "properties": {},
                                                            "childNodes": [
                                                              {"kind": "mo",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"displaystyle": true,
                                                                             "scriptlevel": 0,
                                                                             "form": "infix"},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "−"}],
                                                               "isEmbellished": true}],
                                                            "isInferred": true,
                                                            "isEmbellished": true}],
                                                         "isEmbellished": true}],
                                                      "isInferred": true,
                                                      "isEmbellished": true}],
                                                   "isEmbellished": true}],
                                                "isInferred": true,
                                                "isEmbellished": true}],
                                             "isEmbellished": true},
                                            {"kind": "mpadded",
                                             "texClass": 0,
                                             "attributes": {"height": "+2mu",
                                                            "depth": "-2mu",
                                                            "voffset": "+2mu"},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "TeXAtom",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "mrow",
                                                      "texClass": 0,
                                                      "attributes": {},
                                                      "inherited": {"displaystyle": true,
                                                                    "scriptlevel": 0},
                                                      "properties": {},
                                                      "childNodes": [
                                                        {"kind": "mspace",
                                                         "texClass": 0,
                                                         "attributes": {"width": "2mu"},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [],
                                                         "isSpacelike": true},
                                                        {"kind": "mstyle",
                                                         "texClass": 0,
                                                         "attributes": {"mathsize": "0.5em"},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [
                                                           {"kind": "mrow",
                                                            "texClass": 0,
                                                            "attributes": {},
                                                            "inherited": {"mathsize": "0.5em",
                                                                          "displaystyle": true,
                                                                          "scriptlevel": 0},
                                                            "properties": {},
                                                            "childNodes": [
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "1mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true},
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "1mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true},
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "2mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true}],
                                                            "isInferred": true,
                                                            "isSpacelike": true}],
                                                         "isSpacelike": true}],
                                                      "isInferred": true,
                                                      "isSpacelike": true}]}],
                                                "isInferred": true}]}],
                                          "isInferred": true}]}],
                                    "isInferred": true}]}],
                              "isInferred": true}]}],
                        "isInferred": true}]},
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "postfix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "−"}],
                     "isEmbellished": true}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "B"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "-.2em",
                                                "depth": "+.2em",
                                                "voffset": "-.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mo",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0,
                                                           "form": "infix"},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "text",
                                                "text": "−"}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "+.2em",
                                                "depth": "-.2em",
                                                "voffset": "+.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "TeXAtom",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "mpadded",
                                                   "texClass": 0,
                                                   "attributes": {"width": 0},
                                                   "inherited": {"displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "mrow",
                                                      "texClass": 0,
                                                      "attributes": {},
                                                      "inherited": {"displaystyle": true,
                                                                    "scriptlevel": 0},
                                                      "properties": {},
                                                      "childNodes": [
                                                        {"kind": "mphantom",
                                                         "texClass": 0,
                                                         "attributes": {},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [
                                                           {"kind": "mrow",
                                                            "texClass": 0,
                                                            "attributes": {},
                                                            "inherited": {"displaystyle": true,
                                                                          "scriptlevel": 0},
                                                            "properties": {},
                                                            "childNodes": [
                                                              {"kind": "mo",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"displaystyle": true,
                                                                             "scriptlevel": 0,
                                                                             "form": "infix"},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "−"}],
                                                               "isEmbellished": true}],
                                                            "isInferred": true,
                                                            "isEmbellished": true}],
                                                         "isEmbellished": true}],
                                                      "isInferred": true,
                                                      "isEmbellished": true}],
                                                   "isEmbellished": true}],
                                                "isInferred": true,
                                                "isEmbellished": true}],
                                             "isEmbellished": true},
                                            {"kind": "mpadded",
                                             "texClass": 0,
                                             "attributes": {"height": "+2mu",
                                                            "depth": "-2mu",
                                                            "voffset": "+2mu"},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "mrow",
                                                "texClass": 0,
                                                "attributes": {},
                                                "inherited": {"displaystyle": true,
                                                              "scriptlevel": 0},
                                                "properties": {},
                                                "childNodes": [
                                                  {"kind": "TeXAtom",
                                                   "texClass": 0,
                                                   "attributes": {},
                                                   "inherited": {"displaystyle": true,
                                                                 "scriptlevel": 0},
                                                   "properties": {},
                                                   "childNodes": [
                                                     {"kind": "mrow",
                                                      "texClass": 0,
                                                      "attributes": {},
                                                      "inherited": {"displaystyle": true,
                                                                    "scriptlevel": 0},
                                                      "properties": {},
                                                      "childNodes": [
                                                        {"kind": "mspace",
                                                         "texClass": 0,
                                                         "attributes": {"width": "2mu"},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [],
                                                         "isSpacelike": true},
                                                        {"kind": "mstyle",
                                                         "texClass": 0,
                                                         "attributes": {"mathsize": "0.5em"},
                                                         "inherited": {"displaystyle": true,
                                                                       "scriptlevel": 0},
                                                         "properties": {},
                                                         "childNodes": [
                                                           {"kind": "mrow",
                                                            "texClass": 0,
                                                            "attributes": {},
                                                            "inherited": {"mathsize": "0.5em",
                                                                          "displaystyle": true,
                                                                          "scriptlevel": 0},
                                                            "properties": {},
                                                            "childNodes": [
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "1mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true},
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "1mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true},
                                                              {"kind": "mtext",
                                                               "texClass": 0,
                                                               "attributes": {},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [
                                                                 {"kind": "text",
                                                                  "text": "-"}],
                                                               "isSpacelike": true},
                                                              {"kind": "mspace",
                                                               "texClass": 0,
                                                               "attributes": {"width": "2mu"},
                                                               "inherited": {"mathsize": "0.5em",
                                                                             "displaystyle": true,
                                                                             "scriptlevel": 0},
                                                               "properties": {},
                                                               "childNodes": [],
                                                               "isSpacelike": true}],
                                                            "isInferred": true,
                                                            "isSpacelike": true}],
                                                         "isSpacelike": true}],
                                                      "isInferred": true,
                                                      "isSpacelike": true}]}],
                                                "isInferred": true}]}],
                                          "isInferred": true}]}],
                                    "isInferred": true}]}],
                              "isInferred": true}]}],
                        "isInferred": true}]},
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "postfix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "−"}],
                     "isEmbellished": true}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "-.2em",
                                                "depth": "+.2em",
                                                "voffset": "-.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mo",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0,
                                                           "form": "infix"},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "text",
                                                "text": "−"}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mpadded",
                                 "texClass": 0,
                                 "attributes": {"height": "+.2em",
                                                "depth": "-.2em",
                                                "voffset": "+.2em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "TeXAtom",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mrow",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "mo",
                                             "texClass": 0,
                                             "attributes": {},
                                             "inherited": {"displaystyle": true,
                                                           "scriptlevel": 0,
                                                           "form": "infix"},
                                             "properties": {},
                                             "childNodes": [
                                               {"kind": "text",
                                                "text": "−"}],
                                             "isEmbellished": true}],
                                          "isInferred": true,
                                          "isEmbellished": true}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mpadded",
                           "texClass": 0,
                           "attributes": {"width": 0},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mphantom",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mo",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0,
                                                     "form": "infix"},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "−"}],
                                       "isEmbellished": true}],
                                    "isInferred": true,
                                    "isEmbellished": true}],
                                 "isEmbellished": true}],
                              "isInferred": true,
                              "isEmbellished": true}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "mpadded",
                     "texClass": 0,
                     "attributes": {"height": "+2mu",
                                    "depth": "-2mu",
                                    "voffset": "+2mu"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "TeXAtom",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mrow",
                              "texClass": 0,
                              "attributes": {},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mspace",
                                 "texClass": 0,
                                 "attributes": {"width": "2mu"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [],
                                 "isSpacelike": true},
                                {"kind": "mstyle",
                                 "texClass": 0,
                                 "attributes": {"mathsize": "0.5em"},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mrow",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"mathsize": "0.5em",
                                                  "displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "1mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true},
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "1mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true},
                                      {"kind": "mtext",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "text",
                                          "text": "-"}],
                                       "isSpacelike": true},
                                      {"kind": "mspace",
                                       "texClass": 0,
                                       "attributes": {"width": "2mu"},
                                       "inherited": {"mathsize": "0.5em",
                                                     "displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [],
                                       "isSpacelike": true}],
                                    "isInferred": true,
                                    "isSpacelike": true}],
                                 "isSpacelike": true}],
                              "isInferred": true,
                              "isSpacelike": true}]}],
                        "isInferred": true}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "D"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-63', '\\ce{A\\bond{...}B\\bond{....}C}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "A"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "B"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true},
                    {"kind": "TeXAtom",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mrow",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mo",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0,
                                         "form": "infix"},
                           "properties": {},
                           "childNodes": [
                             {"kind": "text",
                              "text": "⋅"}],
                           "isEmbellished": true}],
                        "isInferred": true,
                        "isEmbellished": true}],
                     "isEmbellished": true}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-64', '\\ce{A\\bond{->}B\\bond{<-}C}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "A"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 3,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 3,
                     "attributes": {"stretchy": false},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix",
                                   "accent": true,
                                   "stretchy": true},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "→"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "B"}]}],
                  "isInferred": true}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 3,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 3,
                     "attributes": {"stretchy": false},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix",
                                   "accent": true,
                                   "stretchy": true},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "←"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-65', '\\ce{KCr(SO4)2*12H2O}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "K"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "r"}]}],
                  "isInferred": true}]},
              {"kind": "mo",
               "texClass": 4,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "("}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "S"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "4"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mo",
               "texClass": 5,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": ")"}],
               "isEmbellished": true},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "⋅"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "mn",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "12"}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "H"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-66', '\\ce{KCr(SO4)2.12H2O}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "K"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "r"}]}],
                  "isInferred": true}]},
              {"kind": "mo",
               "texClass": 4,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "("}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "S"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "4"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mo",
               "texClass": 5,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": ")"}],
               "isEmbellished": true},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "⋅"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "mn",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "12"}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "H"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-67', '\\ce{KCr(SO4)2 * 12 H2O}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "K"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "r"}]}],
                  "isInferred": true}]},
              {"kind": "mo",
               "texClass": 4,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "("}],
               "isEmbellished": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "S"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "4"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mo",
               "texClass": 5,
               "attributes": {"stretchy": false},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0,
                             "form": "infix",
                             "fence": true,
                             "stretchy": true,
                             "symmetric": true},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": ")"}],
               "isEmbellished": true},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mo",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "form": "infix"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "⋅"}],
                     "isEmbellished": true}],
                  "isInferred": true,
                  "isEmbellished": true}],
               "isEmbellished": true},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "mn",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "text",
                  "text": "12"}]},
              {"kind": "mstyle",
               "texClass": 0,
               "attributes": {"scriptlevel": 0},
               "inherited": {"displaystyle": true},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mspace",
                     "texClass": 0,
                     "attributes": {"width": "thinmathspace"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [],
                     "isSpacelike": true}],
                  "isInferred": true,
                  "isSpacelike": true}],
               "isSpacelike": true},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "H"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-68', '\\ce{Fe^{II}Fe^{III}2O4}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "F"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "e"}]}],
                  "isInferred": true}]},
              {"kind": "msup",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mi",
                              "texClass": 0,
                              "attributes": {"mathvariant": "normal"},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1,
                                            "mathvariant": "italic"},
                              "properties": {},
                              "childNodes": [
                                {"kind": "text",
                                 "text": "I"}]},
                             {"kind": "mi",
                              "texClass": 0,
                              "attributes": {"mathvariant": "normal"},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1,
                                            "mathvariant": "italic"},
                              "properties": {},
                              "childNodes": [
                                {"kind": "text",
                                 "text": "I"}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "F"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "e"}]}],
                  "isInferred": true}]},
              {"kind": "msup",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mi",
                              "texClass": 0,
                              "attributes": {"mathvariant": "normal"},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1,
                                            "mathvariant": "italic"},
                              "properties": {},
                              "childNodes": [
                                {"kind": "text",
                                 "text": "I"}]},
                             {"kind": "mi",
                              "texClass": 0,
                              "attributes": {"mathvariant": "normal"},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1,
                                            "mathvariant": "italic"},
                              "properties": {},
                              "childNodes": [
                                {"kind": "text",
                                 "text": "I"}]},
                             {"kind": "mi",
                              "texClass": 0,
                              "attributes": {"mathvariant": "normal"},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1,
                                            "mathvariant": "italic"},
                              "properties": {},
                              "childNodes": [
                                {"kind": "text",
                                 "text": "I"}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "2"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]},
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]},
              {"kind": "msub",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {"texprimestyle": true},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {"texprimestyle": true},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {"texprimestyle": true},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": false,
                                         "scriptlevel": 1},
                           "properties": {"texprimestyle": true},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"height": 0},
                              "inherited": {"displaystyle": false,
                                            "scriptlevel": 1},
                              "properties": {"texprimestyle": true},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": false,
                                               "scriptlevel": 1},
                                 "properties": {"texprimestyle": true},
                                 "childNodes": [
                                   {"kind": "mn",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": false,
                                                  "scriptlevel": 1},
                                    "properties": {"texprimestyle": true},
                                    "childNodes": [
                                      {"kind": "text",
                                       "text": "4"}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);


parserTest.runTest(
  'Chem-69', '\\ce{OCO^{.-}}',
  {"kind": "math",
   "texClass": 0,
   "attributes": {"display": "block"},
   "inherited": {"displaystyle": true,
                 "scriptlevel": 0},
   "properties": {},
   "childNodes": [
     {"kind": "mrow",
      "texClass": 0,
      "attributes": {},
      "inherited": {"displaystyle": true,
                    "scriptlevel": 0},
      "properties": {},
      "childNodes": [
        {"kind": "TeXAtom",
         "texClass": 0,
         "attributes": {},
         "inherited": {"displaystyle": true,
                       "scriptlevel": 0},
         "properties": {},
         "childNodes": [
           {"kind": "mrow",
            "texClass": 0,
            "attributes": {},
            "inherited": {"displaystyle": true,
                          "scriptlevel": 0},
            "properties": {},
            "childNodes": [
              {"kind": "TeXAtom",
               "texClass": 0,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "mrow",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "C"}]},
                    {"kind": "mi",
                     "texClass": 0,
                     "attributes": {"mathvariant": "normal"},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0,
                                   "mathvariant": "italic"},
                     "properties": {},
                     "childNodes": [
                       {"kind": "text",
                        "text": "O"}]}],
                  "isInferred": true}]},
              {"kind": "msup",
               "texClass": -1,
               "attributes": {},
               "inherited": {"displaystyle": true,
                             "scriptlevel": 0},
               "properties": {},
               "childNodes": [
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": true,
                                "scriptlevel": 0},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": true,
                                   "scriptlevel": 0},
                     "properties": {},
                     "childNodes": [
                       {"kind": "TeXAtom",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": true,
                                      "scriptlevel": 0},
                        "properties": {},
                        "childNodes": [
                          {"kind": "mrow",
                           "texClass": 0,
                           "attributes": {},
                           "inherited": {"displaystyle": true,
                                         "scriptlevel": 0},
                           "properties": {},
                           "childNodes": [
                             {"kind": "mpadded",
                              "texClass": 0,
                              "attributes": {"width": 0},
                              "inherited": {"displaystyle": true,
                                            "scriptlevel": 0},
                              "properties": {},
                              "childNodes": [
                                {"kind": "mrow",
                                 "texClass": 0,
                                 "attributes": {},
                                 "inherited": {"displaystyle": true,
                                               "scriptlevel": 0},
                                 "properties": {},
                                 "childNodes": [
                                   {"kind": "mphantom",
                                    "texClass": 0,
                                    "attributes": {},
                                    "inherited": {"displaystyle": true,
                                                  "scriptlevel": 0},
                                    "properties": {},
                                    "childNodes": [
                                      {"kind": "mrow",
                                       "texClass": 0,
                                       "attributes": {},
                                       "inherited": {"displaystyle": true,
                                                     "scriptlevel": 0},
                                       "properties": {},
                                       "childNodes": [
                                         {"kind": "mi",
                                          "texClass": 0,
                                          "attributes": {},
                                          "inherited": {"displaystyle": true,
                                                        "scriptlevel": 0,
                                                        "mathvariant": "italic"},
                                          "properties": {},
                                          "childNodes": [
                                            {"kind": "text",
                                             "text": "X"}]}],
                                       "isInferred": true}]}],
                                 "isInferred": true}]}],
                           "isInferred": true}]}],
                     "isInferred": true}]},
                 {"kind": "TeXAtom",
                  "texClass": 0,
                  "attributes": {},
                  "inherited": {"displaystyle": false,
                                "scriptlevel": 1},
                  "properties": {},
                  "childNodes": [
                    {"kind": "mrow",
                     "texClass": 0,
                     "attributes": {},
                     "inherited": {"displaystyle": false,
                                   "scriptlevel": 1},
                     "properties": {},
                     "childNodes": [
                       {"kind": "mspace",
                        "texClass": 0,
                        "attributes": {"width": "1mu"},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {},
                        "childNodes": [],
                        "isSpacelike": true},
                       {"kind": "mo",
                        "texClass": 2,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1,
                                      "form": "prefix"},
                        "properties": {},
                        "childNodes": [
                          {"kind": "text",
                           "text": "∙"}],
                        "isEmbellished": true},
                       {"kind": "mspace",
                        "texClass": 0,
                        "attributes": {"width": "1mu"},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1},
                        "properties": {},
                        "childNodes": [],
                        "isSpacelike": true},
                       {"kind": "mo",
                        "texClass": 0,
                        "attributes": {},
                        "inherited": {"displaystyle": false,
                                      "scriptlevel": 1,
                                      "form": "postfix"},
                        "properties": {},
                        "childNodes": [
                          {"kind": "text",
                           "text": "−"}],
                        "isEmbellished": true}],
                     "isInferred": true}]}]}],
            "isInferred": true}]}],
      "isInferred": true}]}
);
